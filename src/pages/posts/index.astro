---

import Layout from '../../layouts/Default.astro';
import BlogPostPreview from '../../components/BlogPostPreview.astro';

const title = 'Posts';
const subTitle = 'Matt\'s tips, tricks and musings';
const description = 'Blog posts written by Matt Millican';
const permalink = '/posts';

// Use Astro.glob to fetch all post with associated frontmatter
const unsortedPosts = await Astro.glob("../../posts/**/*.md");
const posts = unsortedPosts.sort(function (a, b) {
	return (
		new Date(b.frontmatter.publishDate).valueOf() - new Date(a.frontmatter.publishDate).valueOf()
	);
});
---

<Layout title={title} description={description} subTitle={subTitle} permalink={permalink}>
  {posts.map(post => (
    <BlogPostPreview
      post={post}
    />
  ))}
</Layout>

